{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/abrikos/WebstormProjects/math/src/pages/post/PostList.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport Pager from \"components/Pager\";\nimport Loader from \"components/Loader\";\nimport \"./post.sass\";\nimport DateFormat from \"components/DateFormat\";\nimport { A } from \"hookrouter\";\nexport default function PostLIst(props) {\n  _s();\n\n  /*this.propTypes = {\n      filter: PropTypes.object,\n  };*/\n  const [posts, setPosts] = useState();\n  const [totalCount, setTotalCount] = useState();\n  const [filter, setFilter] = useState(props.filter);\n  useEffect(init, [filter, props]);\n\n  function init() {\n    const f = filter ? Object.assign(filter, {}) : {\n      where: {}\n    };\n    if (!f.where) f.where = {};\n    f.order = {\n      createdAt: -1\n    };\n    f.limit = 12;\n    f.skip = 0;\n    if (!props.isAdmin) f.where.published = true;\n    setFilter(f);\n    props.store.api('/post/list', f).then(res => {\n      console.log(res);\n      setPosts(res.list);\n      setTotalCount(res.count);\n    });\n  }\n\n  function pageChange(f) {\n    props.store.api('/post/list', f).then(res => setPosts(res.list));\n  }\n\n  if (!posts) return /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 24\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"post-list\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-sm-flex flex-wrap\",\n      children: posts.map(p => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"post-small\",\n        children: [/*#__PURE__*/_jsxDEV(A, {\n          href: p.link,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"img-wrapper\",\n            children: p.previewPath && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: p.previewPath,\n              alt: p.header,\n              className: \"img-fluid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 43\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: p.header\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 46,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n          className: \"d-block text-right text-secondary\",\n          children: /*#__PURE__*/_jsxDEV(DateFormat, {\n            date: p.date\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 70\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 17\n        }, this)]\n      }, p.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 29\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }, this), filter && !!totalCount && /*#__PURE__*/_jsxDEV(Pager, {\n      count: totalCount,\n      filter: filter,\n      onPageChange: pageChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 36\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 12\n  }, this);\n}\n\n_s(PostLIst, \"1xbu8HO7IUjCs1AJ0oiQugcBk7o=\");\n\n_c = PostLIst;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostLIst\");","map":{"version":3,"sources":["/home/abrikos/WebstormProjects/math/src/pages/post/PostList.js"],"names":["React","useEffect","useState","Pager","Loader","DateFormat","A","PostLIst","props","posts","setPosts","totalCount","setTotalCount","filter","setFilter","init","f","Object","assign","where","order","createdAt","limit","skip","isAdmin","published","store","api","then","res","console","log","list","count","pageChange","map","p","link","previewPath","header","date","id"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Pager from \"components/Pager\";\nimport Loader from \"components/Loader\";\nimport \"./post.sass\"\nimport DateFormat from \"components/DateFormat\";\nimport {A} from \"hookrouter\"\n\nexport default function PostLIst(props) {\n    /*this.propTypes = {\n        filter: PropTypes.object,\n    };*/\n\n    const [posts, setPosts] = useState();\n    const [totalCount, setTotalCount] = useState();\n    const [filter, setFilter] = useState(props.filter);\n\n    useEffect(init, [filter, props]);\n\n    function init() {\n        const f = filter ? Object.assign(filter, {}) : {where: {}};\n        if (!f.where) f.where = {};\n        f.order = {createdAt: -1};\n        f.limit = 12;\n        f.skip = 0;\n        if (!props.isAdmin) f.where.published = true;\n        setFilter(f);\n        props.store.api('/post/list', f).then(res => {\n            console.log(res)\n            setPosts(res.list)\n            setTotalCount(res.count);\n        });\n    }\n\n    function pageChange(f) {\n        props.store.api('/post/list', f).then(res => setPosts(res.list));\n    }\n\n    if (!posts) return <Loader/>\n    return <div className=\"post-list\">\n        <div className=\"d-sm-flex flex-wrap\">\n            {posts.map(p => <div key={p.id} className=\"post-small\">\n                <A href={p.link} >\n                    <div className=\"img-wrapper\">\n                        {p.previewPath && <img src={p.previewPath} alt={p.header} className=\"img-fluid\"/>}\n                    </div>\n                    <span>{p.header}</span>\n                </A>\n                <small className=\"d-block text-right text-secondary\"><DateFormat date={p.date}/></small>\n            </div>)}\n        </div>\n        {filter && !!totalCount && <Pager count={totalCount} filter={filter} onPageChange={pageChange}/>}\n    </div>\n}\n"]},"metadata":{},"sourceType":"module"}